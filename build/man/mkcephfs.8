.TH "MKCEPHFS" "8" "April 29, 2013" "dev" "Ceph"
.SH NAME
mkcephfs \- create a ceph file system
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.\" Man page generated from reStructuredText.
.
.SH SYNOPSIS
.nf
\fBmkcephfs\fP \-c \fIceph.conf\fP [ \-\-mkfs ] [ \-a, \-\-all\-hosts [ \-k
\fI/path/to/admin.keyring\fP ] ]
.fi
.sp
.SH DESCRIPTION
.sp
\fBmkcephfs\fP is used to create an empty Ceph file system, possibly
spanning multiple hosts. The ceph.conf file describes the composition
of the entire Ceph cluster, including which hosts are participating,
which daemons run where, and which paths are used to store file system
data or metadata.
.sp
The mkcephfs tool can be used in two ways. If \-a is used, it will use
ssh and scp to connect to remote hosts on your behalf and do the setup
of the entire cluster. This is the easiest solution, but can also be
inconvenient (if you don\(aqt have ssh to connect without prompting for
passwords) or slow (if you have a large cluster).
.sp
Alternatively, you can run each setup phase manually. First, you need
to prepare a monmap that will be shared by each node:
.sp
.nf
.ft C
# prepare
master# mkdir /tmp/foo
master# mkcephfs \-c /etc/ceph/ceph.conf \e
  \-\-prepare\-monmap \-d /tmp/foo
.ft P
.fi
.sp
Share the \fB/tmp/foo\fP directory with other nodes in whatever way is
convenient for you. On each OSD and MDS node:
.sp
.nf
.ft C
osdnode# mkcephfs \-\-init\-local\-daemons osd \-d /tmp/foo
mdsnode# mkcephfs \-\-init\-local\-daemons mds \-d /tmp/foo
.ft P
.fi
.sp
Collect the contents of the /tmp/foo directories back onto a single
node, and then:
.sp
.nf
.ft C
master# mkcephfs \-\-prepare\-mon \-d /tmp/foo
.ft P
.fi
.sp
Finally, distribute \fB/tmp/foo\fP to all monitor nodes and, on each of
those nodes:
.sp
.nf
.ft C
monnode# mkcephfs \-\-init\-local\-daemons mon \-d /tmp/foo
.ft P
.fi
.SH OPTIONS
.INDENT 0.0
.TP
.B \-a, \-\-allhosts
Performs the necessary initialization steps on all hosts in the
cluster, executing commands via SSH.
.UNINDENT
.INDENT 0.0
.TP
.B \-c ceph.conf, \-\-conf=ceph.conf
Use the given conf file instead of the default \fB/etc/ceph/ceph.conf\fP.
.UNINDENT
.INDENT 0.0
.TP
.B \-k /path/to/keyring
When \fB\-a\fP is used, we can specify a location to copy the
client.admin keyring, which is used to administer the cluster. The
default is \fB/etc/ceph/keyring\fP (or whatever is specified in the
config file).
.UNINDENT
.INDENT 0.0
.TP
.B \-\-mkfs
Create and mount the file systems specified in the ceph.conf for
OSD data storage using mkfs.$type. The \fBdevs\fP option in ceph.conf
must specify the device(s) and the \fBosd mkfs type\fP option must
specify the file system type (normally one of btrfs, xfs, or ext4).
.UNINDENT
.INDENT 0.0
.TP
.B \-\-no\-copy\-conf
By default, mkcephfs with \-a will copy the new configuration to
/etc/ceph/ceph.conf on each node in the cluster.  This option
disables that behavior.
.UNINDENT
.SH SUBCOMMANDS
.sp
The sub\-commands performed during cluster setup can be run individually with
.INDENT 0.0
.TP
.B \-\-prepare\-monmap \-d dir \-c ceph.conf
Create an initial monmap with a random fsid/uuid and store it and
the ceph.conf in dir.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-init\-local\-daemons type \-d dir
Initialize any daemons of type type on the local host using the
monmap in dir.  For types osd and mds, the resulting authentication
keys will be placed in dir.  For type mon, the initial data files
generated by \-\-prepare\-mon (below) are expected in dir.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-prepare\-mon \-d dir
Prepare the initial monitor data based on the monmap, OSD, and MDS
authentication keys collected in dir, and put the result in dir.
.UNINDENT
.SH AVAILABILITY
.sp
\fBmkcephfs\fP is part of the Ceph distributed file system. Please refer
to the Ceph documentation at \fI\%http://ceph.com/docs\fP for more
information.
.SH SEE ALSO
.sp
\fBceph\fP(8),
\fBmonmaptool\fP(8),
\fBosdmaptool\fP(8),
\fBcrushtool\fP(8)
.SH COPYRIGHT
2010-2013, Inktank Storage, Inc. and contributors. Licensed under Creative Commons BY-SA
.\" Generated by docutils manpage writer.
.
